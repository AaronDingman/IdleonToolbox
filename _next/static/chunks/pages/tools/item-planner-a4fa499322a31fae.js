(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[2731],{65539:function(n,e,t){(window.__NEXT_P=window.__NEXT_P||[]).push(["/tools/item-planner",function(){return t(65355)}])},65355:function(n,e,t){"use strict";t.r(e),t.d(e,{default:function(){return ne}});var l=t(82729),i=t(85893),a=t(67294),o=t(72032),r=t(21785),s=t(15861),d=t(51233),c=t(61903),u=t(87109),m=t(94054),v=t(40476),p=t(72890),x=t(50480),h=t(36872),j=t(67358),f=t(38895),g=t(22797),y=t(417),Z=t(49425),w=t(69368),b=t(41422),N=t(39574),I=t(83321),C=t(12458),k=t(93946),Q=t(23508),_=t(94895),E=t(34282),T=t(96540),S=t(8364),A=t(61599),F=t(51053),O=t(66242),M=t(44267);function P(){let n=(0,l._)(["\n  width: 40px;\n"]);return P=function(){return n},n}let W=A.Z.img(P()),q=n=>{let{itemName:e,owners:t}=n;return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(s.Z,{fontWeight:"bold",variant:"h5",children:(0,N.cleanUnderscore)(e)}),(0,i.jsx)(d.Z,{children:(0,i.jsx)(d.Z,{direction:"row",children:(null==t?void 0:t.length)>0?null==t?void 0:t.map((n,e)=>(0,i.jsx)("div",{children:(0,i.jsxs)(s.Z,{children:[n,"\xa0"]})},e+""+n)):(0,i.jsx)(s.Z,{children:"None"})})})]})};var z=n=>{var e;let{account:t,inventoryItems:l,itemsList:r=[],copies:c=1,itemDisplay:u}=n,m=(n,e)=>null==n?void 0:n.reduce((n,i)=>{var a,r,s;let d,c;if((null==i?void 0:i.itemName)==="Dungeon_Credits_Flurbo_Edition")d=null!==(r=null==t?void 0:null===(a=t.dungeons)||void 0===a?void 0:a.flurbos)&&void 0!==r?r:0,c=["account"];else{let n=(0,C.AN)(l,null==i?void 0:i.itemName);d=null==n?void 0:n.amount,c=null==n?void 0:n.owner}if("0"===e){let e=(null==i?void 0:i.itemQuantity)-d;if((null==i?void 0:i.type)==="Equip"&&e!==(null==i?void 0:i.itemQuantity)){let t=null===(s=(0,C.F6)(o.crafts[null==i?void 0:i.itemName]))||void 0===s?void 0:s.map(n=>{let{amount:t,owner:i}=(0,C.AN)(l,null==n?void 0:n.itemName);return{...n,baseQuantity:null==n?void 0:n.itemQuantity,itemQuantity:(null==n?void 0:n.itemQuantity)*e,quantityOwned:t,owner:i}});return t.forEach(t=>{var l,i;let a=null==n?void 0:null===(l=n[null==t?void 0:t.subType])||void 0===l?void 0:l.find(n=>(null==n?void 0:n.itemName)===(null==t?void 0:t.itemName)),o=null==n?void 0:null===(i=n[null==t?void 0:t.subType])||void 0===i?void 0:i.filter(n=>(null==n?void 0:n.itemName)!==(null==t?void 0:t.itemName));a&&e>0&&(null==a?void 0:a.itemQuantity)-d>(null==a?void 0:a.quantityOwned)&&(o=[...o||[],{...a,itemQuantity:(null==a?void 0:a.itemQuantity)-d}]),n={...n,[null==t?void 0:t.subType]:o}}),e>0&&(n={...n,[null==i?void 0:i.subType]:[...(null==n?void 0:n[null==i?void 0:i.subType])||[],{...i,quantityOwned:0,owner:c,itemQuantity:e}]}),n}return d>=(null==i?void 0:i.itemQuantity)?n:{...n,[null==i?void 0:i.subType]:[...(null==n?void 0:n[null==i?void 0:i.subType])||[],{...i,owner:c,quantityOwned:d}]}}return"1"!==e?n:{...n,[null==i?void 0:i.subType]:[...(null==n?void 0:n[null==i?void 0:i.subType])||[],{...i,quantityOwned:d,owner:c}]}},{}),v=(0,a.useMemo)(()=>m(r,u),[r,u,l,t]);return(0,i.jsx)(d.Z,{flexWrap:"wrap",direction:"row",gap:4,children:null===(e=Object.entries(v))||void 0===e?void 0:e.map((n,e)=>{let[t,l]=n,a="0"!==u||(null==l?void 0:l.length)>0;return a?(0,i.jsx)(O.Z,{variant:"outlined",children:(0,i.jsxs)(M.Z,{children:[(0,i.jsx)("span",{className:"title",children:(0,N.cleanUnderscore)((0,N.pascalCase)(t))}),(0,i.jsx)(d.Z,{flexWrap:"wrap",direction:"row",gap:3,children:null==l?void 0:l.map((n,e)=>{let{itemName:t,itemQuantity:l,rawName:a,type:o,quantityOwned:r,owner:m}=n;return(0,i.jsxs)(d.Z,{gap:1,alignItems:"center",children:[(0,i.jsx)(F.Z,{title:(0,i.jsx)(q,{itemName:t,owners:m}),children:(0,i.jsx)(W,{src:"".concat(N.prefix,"data/").concat(a,".png"),alt:""})}),(0,i.jsxs)(d.Z,{direction:"row",children:[(0,i.jsx)(F.Z,{title:r>=1e3?(0,N.numberWithCommas)(r):"",children:(0,i.jsx)(s.Z,{color:r>=("0"===u?parseInt(l):parseInt(l)*c)?"success.light":"",children:(0,N.notateNumber)(r)})}),(0,i.jsx)(F.Z,{title:l>=1e3?(0,N.numberWithCommas)(l):"",children:(0,i.jsxs)(s.Z,{color:r>=("0"===u?parseInt(l):parseInt(l)*c)?"success.light":"",children:["/","0"===u?(0,N.notateNumber)(parseInt(l)):(0,N.notateNumber)(parseInt(l)*c,2)]})})]})]},t+""+e)})})]})},t+""+e):null})})},D=t(2962),R=t(14689),U=t(73397);function L(){let n=(0,l._)(["\n  width: 50px;\n"]);return L=function(){return n},n}function X(){let n=(0,l._)(["\n  .item-wrapper {\n    width: 105px;\n    height: 102px;\n    position: relative;\n    display: flex;\n    flex-direction: column;\n    align-items: center;\n  }\n\n  .title {\n    font-size: 20px;\n    font-weight: bold;\n    display: inline-block;\n    margin-bottom: 10px;\n  }\n\n  .preview {\n    min-height: 77px;\n    min-width: 77px;\n  }\n\n  .controls {\n    display: flex;\n    align-items: center;\n    gap: 10px;\n    flex-wrap: wrap;\n    @media (max-width: 800px) {\n      padding: 10px;\n    }\n  }\n\n  .items-wrapper {\n    margin-top: 15px;\n\n    .items {\n      margin-top: 10px;\n      display: flex;\n      flex-wrap: wrap;\n      gap: 15px;\n    }\n  }\n\n  .content {\n    margin-top: 25px;\n    display: grid;\n    grid-template-columns: 1fr 3fr;\n    column-gap: 50px;\n  }\n\n  .crafts-container {\n    margin-top: 15px;\n  }\n"]);return X=function(){return n},n}function B(){let n=(0,l._)(["\n  ","\n  && label.Mui-focused {\n    color: rgba(255, 255, 255, 0.7);\n  }\n"]);return B=function(){return n},n}function V(){let n=(0,l._)(["\n  && {\n    color: white;\n  }\n"]);return V=function(){return n},n}let G=(0,r.D)({trim:!0}),H={rawName:"EquipmentTransparent108"},J=n=>{let{name:e,items:t}=n;return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(s.Z,{fontWeight:"bold",variant:"h5",children:(0,N.cleanUnderscore)(e)}),(0,i.jsx)(d.Z,{direction:"row",gap:1,flexWrap:"wrap",children:null==t?void 0:t.map((n,e)=>{let{rawName:t,itemQuantity:l}=n;return(0,i.jsxs)(d.Z,{alignItems:"center",children:[(0,i.jsx)(K,{src:"".concat(N.prefix,"data/").concat(t,".png"),alt:""}),(0,i.jsx)(s.Z,{children:l})]},t+""+e)})})]})},K=A.Z.img(L()),Y=A.Z.div(X()),$=(0,A.Z)(c.Z)(B(),n=>{let{width:e}=n;return e?"width:".concat(e,";"):""}),nn=(0,A.Z)(w.Z)(V());var ne=n=>{var e,t;let{}=n,{state:l,lastUpdated:r,dispatch:w}=(0,a.useContext)(b.I),{planner:A={sections:[]}}=l,[O]=(0,a.useState)(Object.keys(o.crafts)),[M,P]=(0,a.useState)({0:""}),[W,q]=(0,a.useState)([]),[L,X]=(0,a.useState)([H]),[B,V]=(0,a.useState)("0"),[K,ne]=(0,a.useState)(!1),[nt,nl]=(0,a.useState)(1),[ni,na]=(0,a.useState)({}),[no,nr]=(0,a.useState)(),ns=(0,a.useMemo)(()=>(0,C.tP)(null==l?void 0:l.characters,K),[K]),nd=(0,a.useMemo)(()=>(0,C.Nx)(null==l?void 0:l.characters,null==l?void 0:l.account),[null==l?void 0:l.characters,null==l?void 0:l.account]),nc=(0,a.useRef)();(0,a.useEffect)(()=>{var n;(null==l?void 0:l.characters)||(null==l?void 0:l.account)?q(K?[...nd||[],...ns||[]]:nd):q(o.itemsArray),X(null==A?void 0:null===(n=A.sections)||void 0===n?void 0:n.map(()=>H))},[l,r,K]);let nu=async n=>{let e=n.target.files[0];if(!e||(null==e?void 0:e.type)!=="application/json"){console.error("File isn't a json file");return}let t=await e.text();t&&(null==(t=(0,N.tryToParse)(t))?void 0:t.sections)&&w({type:"planner",data:{sections:null==t?void 0:t.sections}})},nm=(n,e)=>{let t=L.map((t,l)=>l===e?n?o.crafts[n]:H:t);P({...M,["".concat(e)]:n}),X(t)},nv=(n,e,t)=>{var l;let i,a;let r=null==A?void 0:null===(l=A.sections)||void 0===l?void 0:l[n],s=o.crafts[null==e?void 0:e.itemName];if(s){i=nh(null==r?void 0:r.items,s,!1,!1,t);let l=Array.isArray(e)?e:(0,C.F6)(e);a=null==l?void 0:l.reduce((n,e)=>nh(n,e,!0,!1,t),null==r?void 0:r.materials);let o=nx(n,{materials:a,items:i,name:null==r?void 0:r.name});w({type:"planner",data:{sections:o}})}},np=(n,e,t)=>{if((null==e?void 0:e.rawName)!==H.rawName){var l;let i,a;let r=null==A?void 0:null===(l=A.sections)||void 0===l?void 0:l[n];i=nh(null==r?void 0:r.items,e,!1,!0,t);let s=Array.isArray(o.crafts[null==e?void 0:e.itemName])?o.crafts[null==e?void 0:e.itemName]:(0,C.F6)(o.crafts[null==e?void 0:e.itemName]);a=null==s?void 0:s.reduce((n,e)=>nh(n,e,!0,!0,t),null==r?void 0:r.materials);let d=nx(n,{materials:a,items:i,name:null==r?void 0:r.name});w({type:"planner",data:{sections:d}}),P({...M,[n]:""}),nl(1)}},nx=(n,e)=>{var t;return null==A?void 0:null===(t=A.sections)||void 0===t?void 0:t.map((t,l)=>n===l?e:t)},nh=function(n,e,t){let l=!(arguments.length>3)||void 0===arguments[3]||arguments[3],i=arguments.length>4?arguments[4]:void 0,a=null==n?void 0:n.find(n=>(null==e?void 0:e.itemName)===(null==n?void 0:n.itemName));return a?null==n?void 0:n.reduce((n,t)=>{if((null==e?void 0:e.itemName)!==(null==t?void 0:t.itemName))return[...n,t];let o=i?i*(null==e?void 0:e.itemQuantity):null==t?void 0:t.itemQuantity;return!l&&(null==a?void 0:a.itemQuantity)-o<=0?n:[...n,{...a,itemQuantity:l?(null==a?void 0:a.itemQuantity)+o:(null==a?void 0:a.itemQuantity)-o,itemCount:parseFloat(i)}]},[]):l?[...n||[],{...e,itemQuantity:(null==e?void 0:e.itemQuantity)*i,itemCount:parseFloat(i)}]:n},nj=n=>{let e=A.sections.filter((e,t)=>t!==n);P({...M,[n]:""}),w({type:"planner",data:{sections:e}})};return(0,i.jsxs)(Y,{children:[(0,i.jsx)(D.PB,{title:"Idleon Toolbox | Item Planner",description:"Useful tool to keep track of your crafting projects by tracking existing and missing materials"}),(null==l?void 0:l.characters)||(null==l?void 0:l.account)?null:(0,i.jsx)(s.Z,{component:"div",sx:{mb:2},variant:"caption",children:"* This tool will work better if you're logged in"}),(0,i.jsxs)(d.Z,{direction:"row",gap:5,flexWrap:"wrap",children:[(0,i.jsxs)("div",{children:[(0,i.jsx)(d.Z,{direction:"row",alignItems:"center",children:(0,i.jsx)(c.Z,{sx:{mt:1},label:"Section name",placeholder:"Enter section name",onChange:n=>nr(n.target.value),InputProps:{endAdornment:(0,i.jsx)(u.Z,{position:"end",children:(0,i.jsx)(k.Z,{onClick:()=>{w({type:"planner",data:{sections:[...(null==A?void 0:A.sections)||[],{items:[],materials:[],name:no||"section-".concat(Math.floor(100*Math.random()))}]}})},children:(0,i.jsx)(T.Z,{})})})}})}),(0,i.jsx)(F.Z,{title:"This will reset all sections and items",children:(0,i.jsxs)(I.Z,{sx:{mt:1},onClick:()=>{P({0:""}),X([H]),w({type:"planner",data:{sections:[]}})},children:[(0,i.jsx)(E.Z,{})," Reset all sections"]})})]}),(0,i.jsxs)(d.Z,{sx:{pl:1,mt:1},children:[(0,i.jsxs)(m.Z,{children:[(0,i.jsx)(v.Z,{id:"demo-radio-buttons-group-label",children:"Display"}),(0,i.jsxs)(p.Z,{row:!0,"aria-labelledby":"demo-radio-buttons-group-label",defaultValue:"0",name:"radio-buttons-group",onChange:n=>V(n.target.value),children:[(0,i.jsx)(x.Z,{value:"0",control:(0,i.jsx)(h.Z,{}),label:"Show Missing Items"}),(0,i.jsx)(x.Z,{value:"1",control:(0,i.jsx)(h.Z,{}),label:"Show All Items"})]})]}),(0,i.jsx)(x.Z,{control:(0,i.jsx)(nn,{checked:K,onChange:()=>ne(!K),name:"Include Equipped Items",color:"default"}),label:"Include Equipped Items"})]}),(0,i.jsxs)(d.Z,{gap:1,sx:{ml:"auto"},alignItems:"center",justifyContent:"center",direction:"row",children:[(0,i.jsx)(F.Z,{title:"Export all sections",children:(0,i.jsxs)(I.Z,{onClick:()=>{var n;let e=localStorage.getItem("planner");e&&(null==A?void 0:null===(n=A.sections)||void 0===n?void 0:n.length)!==0&&(0,N.downloadFile)(e,"it-item-planner.json")},children:[(0,i.jsx)(R.Z,{sx:{mr:1}}),"Export"]})}),(0,i.jsx)(F.Z,{title:"Import (this will override your sections)",children:(0,i.jsxs)(I.Z,{onClick:()=>{nc.current.click()},children:[(0,i.jsx)(U.Z,{sx:{mr:1}}),"Import"]})}),(0,i.jsx)("input",{type:"file",id:"file",ref:nc,style:{display:"none"},accept:".json",onChange:nu})]})]}),(0,i.jsx)(d.Z,{sx:{mt:2},children:(null==A?void 0:null===(e=A.sections)||void 0===e?void 0:e.length)>0?null==A?void 0:null===(t=A.sections)||void 0===t?void 0:t.map((n,e)=>{var t;let{items:r,materials:c,name:u}=n;return(0,i.jsxs)(j.Z,{children:[(0,i.jsx)(f.Z,{expandIcon:(0,i.jsx)(Q.Z,{}),"aria-controls":"panel1a-content",id:"panel1a-header",children:(0,i.jsx)(s.Z,{children:u||"Accordion-".concat(e)})}),(0,i.jsxs)(g.Z,{children:[(0,i.jsxs)(I.Z,{onClick:()=>nj(e),children:[(0,i.jsx)(_.Z,{})," Remove Section"]}),(0,i.jsxs)("div",{className:"controls",children:[(0,i.jsx)("div",{className:"preview",children:(null==L?void 0:L[e])?(0,i.jsx)("img",{src:"".concat(N.prefix,"data/").concat(null==L?void 0:null===(t=L[e])||void 0===t?void 0:t.rawName,".png"),alt:""}):null}),(0,i.jsx)(y.Z,{id:"item-locator",value:null==M?void 0:M[e],onChange:(n,t)=>nm(t,e),autoComplete:!0,options:[null==M?void 0:M[e],...O],filterSelectedOptions:!0,filterOptions:G,getOptionLabel:n=>n?null==n?void 0:n.replace(/_/g," "):"",renderOption:(n,e)=>{var t,l;return e?(0,a.createElement)(d.Z,{gap:2,...n,key:null===o.crafts||void 0===o.crafts?void 0:null===(t=o.crafts[e])||void 0===t?void 0:t.rawName,direction:"row",children:[(0,i.jsx)("img",{width:24,height:24,src:"".concat(N.prefix,"data/").concat(null===o.crafts||void 0===o.crafts?void 0:null===(l=o.crafts[e])||void 0===l?void 0:l.rawName,".png"),alt:""}),null==e?void 0:e.replace(/_/g," ")]}):(0,i.jsx)("span",{style:{height:0}},"empty")},style:{width:300},renderInput:n=>(0,i.jsx)($,{...n,label:"Item Name",variant:"outlined"})}),(0,i.jsx)($,{value:nt,width:"100px",inputProps:{min:1},onChange:n=>{var e;return nl(null==n?void 0:null===(e=n.target)||void 0===e?void 0:e.value)},type:"number",label:"Item Count",variant:"outlined"}),(0,i.jsx)(I.Z,{color:"primary",variant:"contained",onClick:()=>np(e,null==L?void 0:L[e],nt),title:"Add Item",children:"Add"})]}),(0,i.jsxs)("div",{className:"content",children:[(0,i.jsxs)("div",{className:"items-wrapper",children:[(0,i.jsx)("span",{className:"title",children:"Tracked Items"}),(0,i.jsx)("div",{className:"items",children:null==r?void 0:r.map((n,t)=>(0,i.jsxs)("div",{className:"item-wrapper",onMouseEnter:()=>na({...ni,["".concat(e,"-").concat(t)]:!0}),onMouseLeave:()=>na({...ni,["".concat(e,"-").concat(t)]:!1}),children:[(0,i.jsx)(Z.Z,{badgeContent:(0,N.numberWithCommas)(null==n?void 0:n.itemQuantity),max:1e4,anchorOrigin:{vertical:"top",horizontal:"right"},color:"primary",children:(0,i.jsx)(F.Z,{title:(0,i.jsx)(J,{name:null==n?void 0:n.itemName,items:(0,C.F6)(n)}),children:(0,i.jsx)("img",{src:"".concat(N.prefix,"data/").concat(null==n?void 0:n.rawName,".png"),alt:""},(null==n?void 0:n.rawName)+" "+t)})}),(null==ni?void 0:ni["".concat(e,"-").concat(t)])?(0,i.jsxs)("div",{className:"buttons",children:[(0,i.jsx)(k.Z,{type:"bottom",size:"small",onClick:()=>np(e,{...n,itemQuantity:1},1),children:(0,i.jsx)(T.Z,{})}),(0,i.jsx)(k.Z,{type:"bottom",size:"small",onClick:()=>nv(e,n,1),children:(0,i.jsx)(_.Z,{})}),(0,i.jsx)(k.Z,{size:"small",onClick:()=>nv(e,n,null==n?void 0:n.itemQuantity),children:(0,i.jsx)(S.Z,{})})]}):null]},e+""+(null==n?void 0:n.itemName)+t))})]}),(0,i.jsxs)("div",{className:"crafts-container",children:[(0,i.jsx)("span",{className:"title",children:"Required Materials"}),(null==W?void 0:W.length)>0?(0,i.jsx)(z,{itemsList:c,account:null==l?void 0:l.account,inventoryItems:W,itemDisplay:B}):null]})]})]})]},"accordion-".concat(e))}):(0,i.jsx)(s.Z,{sx:{mt:3},variant:"h3",children:"Please add a section"})})]})}}},function(n){n.O(0,[9584,3536,6141,9774,2888,179],function(){return n(n.s=65539)}),_N_E=n.O()}]);